# Auth Gate (Signup / Login modal)

## Поведение

- Модалка показывается, если пользователь **не авторизован** (`user == null`).
- Не показывается на страницах: `/login`, `/verify-email`, `/privacy`, `/terms` (и вложенных).
- Закрытие по крестику сохраняется в **sessionStorage**:
  - **24h** (по умолчанию): не показывать 24 часа.
  - **session**: не показывать до закрытия вкладки.
- При успешной регистрации или входе модалка закрывается; при неподтверждённом email — редирект на `/verify-email`.

## Включение / выключение по страницам

Изменить список страниц, на которых модалка **не показывается**, можно в `lib/auth/useAuthGate.ts`:

```ts
const ALLOWLIST = ["/login", "/verify-email", "/privacy", "/terms"];
```

- **Добавить страницу** (модалка не показывается): добавить путь в `ALLOWLIST`, например `"/about"` или `"/pricing"`.
- **Убрать страницу** (модалка снова показывается): удалить путь из `ALLOWLIST`.

Поддерживаются префиксы: если в списке есть `/privacy`, то и `/privacy/cookies` не показывают gate.

## Вариант закрытия (session vs 24h)

В `components/auth/AuthGateGate.tsx`:

```ts
const AUTH_GATE_VARIANT: "session" | "24h" = "24h";
```

- `"24h"` — после закрытия модалка не показывается 24 часа.
- `"session"` — не показывается до закрытия вкладки.

## Отключение gate глобально

В `app/layout.tsx` удалить или закомментировать `<AuthGateGate />`.
